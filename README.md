
# 🎈 Virtual Stock Festival

휴대폰으로 접속해 가상의 주식을 사고파는, 학교 축제용 실시간 웹앱입니다.

## 주요 기능
- **실시간 가격 변동**: 매수/매도 체결량에 따라 즉시 가격이 바뀝니다.
- **변동계수**: 변동계수가 높을수록 가격 갱신 주기가 짧아지고(더 자주 바뀜), 체결 1건이 미치는 **가격 영향력**도 커집니다.
- **모바일 우선 UI**: 닉네임만으로 참가, 간단한 매수/매도 버튼.
- **관리자 페이지**: 가격/변동계수 조정, 종목 추가, 거래 일시정지, 전체 초기화, 유저 잔액 조정.

## 빠른 시작
> 사전 준비: Node.js LTS(18+) 설치

```bash
# 1) 압축 해제 후 폴더로 이동
cd virtual-stock-festival

# 2) 의존성 설치
npm install

# 3) (선택) 관리자 키 지정
# macOS/Linux
export ADMIN_KEY='나만의비번'
# Windows PowerShell
setx ADMIN_KEY "나만의비번"

# 4) 실행
npm start
```

같은 와이파이에 있는 친구들에게 **서버가 실행된 컴퓨터의 IP**와 포트를 알려주세요.
예: `http://192.168.0.23:3000`  
관리자 페이지: `http://192.168.0.23:3000/admin.html` (접속 후 **ADMIN_KEY** 입력)

> **TIP:** Windows에서 IP 확인: `ipconfig` / macOS: `ifconfig` 또는 메뉴바 Wi‑Fi 정보

## 기본 설정
- 시작 잔액: 10,000원
- 초기 종목: `FEST` (기준가 100원, 변동계수 1.0)
- 기본 틱 주기: 2000ms (변동계수 2 → 1000ms, 0.5 → 4000ms)
- 유동성: 800 (클수록 개별 체결의 가격 영향이 작음)

이 값들은 `server.js` 상단의 `defaultState.config`에서 바꿀 수 있어요.

## 가격 모델(간단 설명)
1) **체결 영향(이벤트)**  
   - 매수/매도 1건이 체결될 때마다:  
     `새가격 = 현재가 * exp(±(수량 / 유동성) * 변동계수)`  
   - 변동계수가 클수록 체결 1건의 영향이 커집니다.

2) **틱 갱신(시간)**  
   - 종목별 타이머가 돌아가며 **작은 무작위 변동 + 기준가로의 완만한 복원력**을 적용합니다.  
   - 틱 간격 = `max(250ms, baseTickMs / 변동계수)`

관리자 페이지에서 **가격·변동계수 조정, 일시정지/재개**를 즉시 적용할 수 있습니다.

## 운영 팁
- 혼잡 시간에는 변동계수를 1.5~2.5로 올려 **역동적인 변동**을 주고, 한산할 때는 0.6~1.0으로 낮춰 과도한 급등락을 방지하세요.
- **유동성**(liquidity)을 올리면 큰 주문의 가격 충격이 완화됩니다.
- 필요 시 `전체 초기화`로 종목 가격을 기준가로 되돌리고 참가자 데이터를 삭제할 수 있습니다.

## 데이터 저장
- 서버가 자동으로 `state.json`을 저장/갱신합니다(같은 폴더). 다시 실행하면 이어서 복구됩니다.

## 보안 주의
- 관리자 키(`ADMIN_KEY`)는 기본값 `festival2025` 입니다. **반드시 변경**하고, 외부에 공유하지 마세요.
- 본 앱은 **축제/교육용**으로 설계되었습니다(실거래 X).

## 자주 묻는 질문
- **여러 종목 만들 수 있나요?** → 네. 관리자 페이지 상단에서 티커/이름/가격/변동계수 입력 후 `종목 추가` 버튼을 누르세요.
- **같은 닉네임으로 다시 들어오면?** → 같은 계정으로 접속됩니다.
- **가격이 너무 급등락해요** → 변동계수를 낮추거나, `server.js`의 `liquidity` 값을 키우세요.
- **모바일에서 느려요** → 같은 와이파이에 많은 사용자가 있으면 Wi‑Fi가 혼잡할 수 있습니다. 포트포워딩 없이 **로컬 네트워크**에서만 사용하세요.
```


## ☁️ 클라우드 배포 가이드(단일 종목 · 시작잔액 0원 · 운영자 지급)

> 이 폴더는 **클라우드 배포용**으로 기본값을 조정했습니다.
> - 시작 잔액: 0원 (운영자가 관리자 → '유저 잔액 조정'으로 지급)
> - 단일 종목: FEST (필요 시 관리자에서 추가 가능)
> - ADMIN_KEY: 기본값 `festival2025` (추후 교체 권장)

### A) Render.com (간단)
1. 새 Web Service 생성 → 리포지토리 연결(또는 직접 업로드).
2. Build Command: `npm install`
3. Start Command: `node server.js`
4. Environment Variable 추가: `ADMIN_KEY=festival2025`
5. 배포 후 접속 URL에서
   - 참가자: `/`
   - 관리자: `/admin.html` → ADMIN_KEY 입력

### B) Railway.app (간단)
1. 새 프로젝트 → Deploy from Repo/Template.
2. Start Command: `node server.js`
3. Variables: `ADMIN_KEY=festival2025`
4. Health check path: `/health`

### C) Docker (범용)
```bash
docker build -t vsf .
docker run -p 3000:3000 -e ADMIN_KEY="festival2025" vsf
```
- 퍼블릭 클라우드(EC2, Lightsail 등)에서 보안그룹/방화벽에 3000 포트 열기.

### 접속
- 참가자: `https://<배포 URL>/`
- 관리자: `https://<배포 URL>/admin.html` → ADMIN_KEY로 로그인
